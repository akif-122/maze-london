<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- OWL CAROUSEL  -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css" />


    <!-- FONTAWESOME ICON  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- BOOTSTRAP CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css" />

    <!-- CUSTOM CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/basket.css">



</head>

<body>

    <div class="wrapper">

        <!-- HEADER SECTION START -->
        <header class="header " style="z-index: 1000 ;">
            <nav class="navbar navbar-expand-lg ">
                <div class="container">
                    <a href="#">
                        <img src="assets/imgs/logo.jpg" width="100" alt="">
                    </a>

                    <div class="collapse navbar-collapse" id="topNav">
                        <ul class="navbar-nav mx-auto">
                            <li><a href="index.html">Home</a></li>
                            <li><a href="#">About</a></li>
                            <li><a href="basket.html">Basket</a></li>
                            <li><a href="#">Social</a></li>
                        </ul>
                    </div>

                    <div class="right-link d-flex align-items-center gap-3">
                        <a href="basket.html" class="basket">
                            <i class="fa-solid fa-cart-shopping"></i> Basket <span id="cart-item"
                                class="bg-danger p-2 rounded-full">0</span>
                        </a>
                        <!-- <a href="#">
                                    <i class="fa-solid fa-user"></i> Profile
                                </a> -->
                    </div>
                    <button class="navbar-toggler" data-bs-target="#topNav" data-bs-toggle="collapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>


                </div>
            </nav>
        </header>
        <!-- HEADER SECTION END -->

        <!-- BASKET SECTION START -->
        <section class="basket-container">
            <div class="container">
                <div class="basket">
                    <h3>Basket</h3>

                    <div class="basket-items" id="cart-items">
                        <!-- DATA COMES FROM JAVASCRIPT -->
                    </div>

                </div>
            </div>
        </section>
        <!-- BASKET SECTION END -->




    </div>



    <!-- JQUERY  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <!-- OWL CAROUSEL -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

    <!-- AOS ANIMATION -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>

    <!-- BOOTSTRAP JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.bundle.min.js"></script>

    <script>

        let cartItemsEle = document.getElementById("cart-items");


        // BASKET COUNT
        const basketCount = (items) => {
            let basketCount = document.getElementById("cart-item");
            basketCount.innerHTML = items;
        }


        const callData = () => {
            let getItems = JSON.parse(localStorage.getItem("cart"));



            // CART ITEMS
            const items = JSON.parse(localStorage.getItem("cart"));
            basketCount(items.length);

            getItems.forEach((product) => {

                let div = document.createElement("div");
                div.className = "item";

                div.innerHTML = ` <div class="img">
                                <img src=${product.image} width="100" alt="">
                            </div>
                            <h5>${product.title}</h5>

                            <p>$ ${product.price}</p>

                            <div class="btns d-flex align-items-center">
                                <button>-</button>
                                <p id="item-count">${product.qty}</p>
                                <button>+</button>
                            </div>

                            <div class="remove-Item">
                                <button id="remove-item">Remove</button>
                            </div>`;

                cartItemsEle.appendChild(div)

                div.addEventListener("click", (e) => {
                    if (e.target.id == "remove-item") {
                        removeFromBasket(product.id)

                    }
                })

            })

        }

        callData()

        const removeFromBasket = (id) => {
            let getItems = JSON.parse(localStorage.getItem("cart"));

            let removeItem = getItems.filter((item) => item.id !== id);

            localStorage.setItem("cart", JSON.stringify(removeItem));

            replaceData()
            // window.location.reload();

            // CART ITEMS
            const items = JSON.parse(localStorage.getItem("cart"));
            basketCount(items.length);

        }


        const replaceData = () => {
            let getItems = JSON.parse(localStorage.getItem("cart"));
            let cartItemsEle = document.getElementById("cart-items");
            let newDiv = document.createElement("div")
            newDiv.className = "basket-items";
            newDiv.id = "cart-items";

            getItems.forEach((product) => {
                let div = document.createElement("div");
                div.className = "item";

                div.innerHTML = `<div class="img">
                                <img src=${product.image} width="100" alt="">
                            </div>
                            <h5>${product.title}</h5>

                            <p>$ ${product.price}</p>

                            <div class="btns d-flex align-items-center">
                                <button>-</button>
                                <p id="item-count">${product.qty}</p>
                                <button>+</button>
                            </div>

                            <div class="remove-Item">
                                <button id="remove-item">Remove</button>
                            </div>`;;

                newDiv.appendChild(div)
                div.addEventListener("click", (e) => {
                    if (e.target.id == "remove-item") {
                        removeFromBasket(product.id)

                    }
                })
            })

            cartItemsEle.replaceWith(newDiv)
            // CART ITEMS
            const items = JSON.parse(localStorage.getItem("cart"));
            basketCount(items.length);
        }

        // // API CALL
        // let apiUrl = "https://fakestoreapi.com/products";
        // let main = document.getElementById("product-list");


        // // BASKET COUNT
        // const basketCount = (items) => {
        //     let basketCount = document.getElementById("cart-item");
        //     basketCount.innerHTML = items;
        // }

        // // CART ITEMS
        // const items = JSON.parse(localStorage.getItem("cart"));
        // basketCount(items.length);


        // const addDataToHtml = (product) => {
        //     let div = document.createElement("div", null);
        //     div.className = "col-md-3 px-2 mb-4";
        //     div.innerHTML = `<div div class="product h-100" >
        //                     <div class="product-img">
        //                         <img src=${product.image} width="100%" alt="">
        //                     </div>
        //                     <div class="product-text">
        //                         <h5><a href="#">${product.title}</a> </h5>
        //                         <p>$${product.price}</p>
        //                         <button class="add-cart"  >Add to Cart</button>
        //                     </div>
        //                 </div >`

        //     main.appendChild(div)

        //     div.addEventListener("click", (e) => {


        //         if (e.target.className == "add-cart") {
        //             addToCart(product)
        //         }
        //     })

        // }



        // let cartItem = JSON.parse(localStorage.getItem("cart"));
        // const cart = localStorage.setItem("cart", JSON.stringify(cartItem))
        // // console.log(cartItem.length);
        // const addToCart = (product) => {
        //     let isInCart = cartItem.findIndex((value) => value.id == product.id);

        //     if (cartItem.length <= 0) {

        //         cartItem = [{ ...product, qty: 1 }];
        //     } else if (isInCart < 0) {
        //         cartItem.push({ ...product, qty: 1 });
        //     } else {
        //         cartItem[isInCart].qty = cartItem[isInCart].qty + 1;
        //     }


        //     localStorage.setItem("cart", JSON.stringify(cartItem));
        //     let iteCount = JSON.parse(localStorage.getItem("cart"));

        //     basketCount(iteCount.length)

        // }


        // const getData = async () => {
        //     try {

        //         const res = await fetch(apiUrl);
        //         const data = await res.json();
        //         console.log(data)




        //         data.forEach((item) => {

        //             addDataToHtml(item);



        //         })





        //     } catch (error) {
        //         console.log(error)
        //     }
        // }

        // getData()


    </script>

</body>

</html>